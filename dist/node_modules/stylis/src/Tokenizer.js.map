{"version":3,"file":"Tokenizer.js","sources":["../../../../node_modules/stylis/src/Tokenizer.js"],"sourcesContent":["import {from, trim, charat, strlen, substr, append, assign} from './Utility.js'\n\nexport var line = 1\nexport var column = 1\nexport var length = 0\nexport var position = 0\nexport var character = 0\nexport var characters = ''\n\n/**\n * @param {string} value\n * @param {object | null} root\n * @param {object | null} parent\n * @param {string} type\n * @param {string[] | string} props\n * @param {object[] | string} children\n * @param {object[]} siblings\n * @param {number} length\n */\nexport function node (value, root, parent, type, props, children, length, siblings) {\n\treturn {value: value, root: root, parent: parent, type: type, props: props, children: children, line: line, column: column, length: length, return: '', siblings: siblings}\n}\n\n/**\n * @param {object} root\n * @param {object} props\n * @return {object}\n */\nexport function copy (root, props) {\n\treturn assign(node('', null, null, '', null, null, 0, root.siblings), root, {length: -root.length}, props)\n}\n\n/**\n * @param {object} root\n */\nexport function lift (root) {\n\twhile (root.root)\n\t\troot = copy(root.root, {children: [root]})\n\n\tappend(root, root.siblings)\n}\n\n/**\n * @return {number}\n */\nexport function char () {\n\treturn character\n}\n\n/**\n * @return {number}\n */\nexport function prev () {\n\tcharacter = position > 0 ? charat(characters, --position) : 0\n\n\tif (column--, character === 10)\n\t\tcolumn = 1, line--\n\n\treturn character\n}\n\n/**\n * @return {number}\n */\nexport function next () {\n\tcharacter = position < length ? charat(characters, position++) : 0\n\n\tif (column++, character === 10)\n\t\tcolumn = 1, line++\n\n\treturn character\n}\n\n/**\n * @return {number}\n */\nexport function peek () {\n\treturn charat(characters, position)\n}\n\n/**\n * @return {number}\n */\nexport function caret () {\n\treturn position\n}\n\n/**\n * @param {number} begin\n * @param {number} end\n * @return {string}\n */\nexport function slice (begin, end) {\n\treturn substr(characters, begin, end)\n}\n\n/**\n * @param {number} type\n * @return {number}\n */\nexport function token (type) {\n\tswitch (type) {\n\t\t// \\0 \\t \\n \\r \\s whitespace token\n\t\tcase 0: case 9: case 10: case 13: case 32:\n\t\t\treturn 5\n\t\t// ! + , / > @ ~ isolate token\n\t\tcase 33: case 43: case 44: case 47: case 62: case 64: case 126:\n\t\t// ; { } breakpoint token\n\t\tcase 59: case 123: case 125:\n\t\t\treturn 4\n\t\t// : accompanied token\n\t\tcase 58:\n\t\t\treturn 3\n\t\t// \" ' ( [ opening delimit token\n\t\tcase 34: case 39: case 40: case 91:\n\t\t\treturn 2\n\t\t// ) ] closing delimit token\n\t\tcase 41: case 93:\n\t\t\treturn 1\n\t}\n\n\treturn 0\n}\n\n/**\n * @param {string} value\n * @return {any[]}\n */\nexport function alloc (value) {\n\treturn line = column = 1, length = strlen(characters = value), position = 0, []\n}\n\n/**\n * @param {any} value\n * @return {any}\n */\nexport function dealloc (value) {\n\treturn characters = '', value\n}\n\n/**\n * @param {number} type\n * @return {string}\n */\nexport function delimit (type) {\n\treturn trim(slice(position - 1, delimiter(type === 91 ? type + 2 : type === 40 ? type + 1 : type)))\n}\n\n/**\n * @param {string} value\n * @return {string[]}\n */\nexport function tokenize (value) {\n\treturn dealloc(tokenizer(alloc(value)))\n}\n\n/**\n * @param {number} type\n * @return {string}\n */\nexport function whitespace (type) {\n\twhile (character = peek())\n\t\tif (character < 33)\n\t\t\tnext()\n\t\telse\n\t\t\tbreak\n\n\treturn token(type) > 2 || token(character) > 3 ? '' : ' '\n}\n\n/**\n * @param {string[]} children\n * @return {string[]}\n */\nexport function tokenizer (children) {\n\twhile (next())\n\t\tswitch (token(character)) {\n\t\t\tcase 0: append(identifier(position - 1), children)\n\t\t\t\tbreak\n\t\t\tcase 2: append(delimit(character), children)\n\t\t\t\tbreak\n\t\t\tdefault: append(from(character), children)\n\t\t}\n\n\treturn children\n}\n\n/**\n * @param {number} index\n * @param {number} count\n * @return {string}\n */\nexport function escaping (index, count) {\n\twhile (--count && next())\n\t\t// not 0-9 A-F a-f\n\t\tif (character < 48 || character > 102 || (character > 57 && character < 65) || (character > 70 && character < 97))\n\t\t\tbreak\n\n\treturn slice(index, caret() + (count < 6 && peek() == 32 && next() == 32))\n}\n\n/**\n * @param {number} type\n * @return {number}\n */\nexport function delimiter (type) {\n\twhile (next())\n\t\tswitch (character) {\n\t\t\t// ] ) \" '\n\t\t\tcase type:\n\t\t\t\treturn position\n\t\t\t// \" '\n\t\t\tcase 34: case 39:\n\t\t\t\tif (type !== 34 && type !== 39)\n\t\t\t\t\tdelimiter(character)\n\t\t\t\tbreak\n\t\t\t// (\n\t\t\tcase 40:\n\t\t\t\tif (type === 41)\n\t\t\t\t\tdelimiter(type)\n\t\t\t\tbreak\n\t\t\t// \\\n\t\t\tcase 92:\n\t\t\t\tnext()\n\t\t\t\tbreak\n\t\t}\n\n\treturn position\n}\n\n/**\n * @param {number} type\n * @param {number} index\n * @return {number}\n */\nexport function commenter (type, index) {\n\twhile (next())\n\t\t// //\n\t\tif (type + character === 47 + 10)\n\t\t\tbreak\n\t\t// /*\n\t\telse if (type + character === 42 + 42 && peek() === 47)\n\t\t\tbreak\n\n\treturn '/*' + slice(index, position - 1) + '*' + from(type === 47 ? type : next())\n}\n\n/**\n * @param {number} index\n * @return {string}\n */\nexport function identifier (index) {\n\twhile (!token(peek()))\n\t\tnext()\n\n\treturn slice(index, position)\n}\n"],"names":["line","column","length","position","character","characters","node","value","root","parent","type","props","children","siblings","copy","assign","lift","append","char","prev","charat","next","peek","caret","slice","begin","end","substr","token","alloc","strlen","dealloc","delimit","trim","delimiter","whitespace","escaping","index","count","commenter","from","identifier"],"mappings":"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","x_google_ignoreList":[0]}